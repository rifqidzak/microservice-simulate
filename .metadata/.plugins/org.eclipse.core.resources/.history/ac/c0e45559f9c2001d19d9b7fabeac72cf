package com.example.microservice.core.util;

import java.security.KeyPair;
import java.util.Map;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Component;

import io.jsonwebtoken.Claims;
import io.jsonwebtoken.Jwts;
import io.jsonwebtoken.SignatureAlgorithm;
import io.jsonwebtoken.security.Keys;

@Component
public class JwtUtil {

	private String keyPublic = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA7RqbTIbTOv4QjSdsxdAvQdYgmIPxkhWHP90CIcTWZCXXJ3ZQ0xe0LFnWt64Gdg9yJvuOlV1qhe1a0t/AHrx5ZfgHIbPhfoJF9SOwoeAeMfuk3dBHY6ACM5ONQ1xut3r2LzaEQ6zT3w84o7WBWE3SAcUSrbzX31fWdpClj3jDp8m582OBNM6sIhGw7VjBM4HdBGsZWsfz+72sqUyjcpv8eRgteNKGPr5XtG836TEjXfWn1GUH6flSsvZ0k67pz6QzHQ1h7FoYkHeh2G0iLtol16xyTvFvPlr4EDhMVzs+DSQfHPkG5lZ8xyFZOqSDF/rviRuRekcZyL4N0a6b51miQwIDAQAB";

	public Claims parseJwt(final String token) {
		return Jwts.parserBuilder().setSigningKey(keyPublic).build().parseClaimsJws(token).getBody();
	}

	public String generateJwt(Map<String, Object> claims) {
		System.out.println(key.getPublic());
		System.out.println(key.getPrivate());
		final String jwt = Jwts.builder().setClaims(claims).signWith(key.getPrivate()).compact();
		return jwt;
	}
}
